package com.alibaba.innodb.java.reader.column;

import com.alibaba.innodb.java.reader.AbstractTest;
import com.alibaba.innodb.java.reader.page.index.GenericRecord;
import com.alibaba.innodb.java.reader.schema.Column;
import com.alibaba.innodb.java.reader.schema.TableDef;
import com.google.common.collect.ImmutableList;
import org.junit.Test;

import java.util.Arrays;
import java.util.List;
import java.util.function.Consumer;

import static org.hamcrest.core.Is.is;
import static org.junit.Assert.assertThat;

public class ColumnJsonTableReaderTest  extends AbstractTest {
    public TableDef getTableDef() {
        return new TableDef()
                .addColumn(new Column().setName("id").setType("int").setNullable(false).setPrimaryKey(true))
                .addColumn(new Column().setName("activity_id").setType("int").setNullable(true))
                .addColumn(new Column().setName("splits").setType("json").setNullable(true))
                .addColumn(new Column().setName("gps_position").setType("json").setNullable(true))
                .addColumn(new Column().setName("created_at").setType("datetime").setNullable(false))
                .addColumn(new Column().setName("updated_at").setType("datetime").setNullable(false));
    }


    /*
    String createTableSql = "CREATE TABLE `activity_details` (\n" +
            "  `id` int NOT NULL AUTO_INCREMENT,\n" +
            "  `activity_id` int DEFAULT NULL,\n" +
            "  `splits` json DEFAULT NULL,\n" +
            "  `gps_positions` json DEFAULT NULL,\n" +
            "  `created_at` datetime NOT NULL,\n" +
            "  `updated_at` datetime NOT NULL,\n" +
            "  PRIMARY KEY (`id`),\n" +
            "  KEY `index_activity_details_on_activity_id` (`activity_id`)\n" +
            ")";
    */

    @Test
    public void testIntColumnMysql80() {
        assertTestOf(this)
                .withMysql80()
                .withTableDef(getTableDef())
                .checkAllRecordsIs(expected());
    }

    public Consumer<List<GenericRecord>> expected() {
        return recordList -> {

            assertThat(recordList.size(), is(1));

            Object[] expected = new Object[]{
                    4,
                    32,
                    "[[1, 1505484838176, 0], [2, 1505484902000, 109], [3, 1505485012618, 184], [4, 1505485071708, 100], [5, 1505485149000, 123]]",
                    "[[-0.49269309, 38.34871583, 99, 1505485360000], [-0.49268157, 38.34871851, 99, 1505485359000], [-0.49267093, 38.34872294, 100, 1505485358000], [-0.49265813, 38.34873175, 100, 1505485356000], [-0.49265092, 38.34873191, 97, 1505485355000], [-0.49263465, 38.34873114, 99, 1505485354000], [-0.49261875, 38.34873677, 99, 1505485353000], [-0.49260173, 38.34873304, 98, 1505485352000], [-0.49258578, 38.34872202, 98, 1505485351000], [-0.49256866, 38.3487115, 98, 1505485350000], [-0.49254909, 38.34870425, 98, 1505485349000], [-0.49252839, 38.34870393, 99, 1505485348000], [-0.49250254, 38.34872817, 99, 1505485346000], [-0.49249525, 38.34874676, 99, 1505485345000], [-0.49248306, 38.34876369, 100, 1505485344000], [-0.49246638, 38.34877922, 100, 1505485343000], [-0.4924459, 38.34879093, 100, 1505485342000], [-0.49242555, 38.34880635, 100, 1505485341000], [-0.49240506, 38.34882451, 99, 1505485340000], [-0.49239103, 38.34884398, 99, 1505485339000], [-0.49238149, 38.3488689, 99, 1505485338000], [-0.49236539, 38.34893789, 100, 1505485336000], [-0.4923543, 38.34897305, 100, 1505485335000], [-0.49233812, 38.34899649, 100, 1505485334000], [-0.49231842, 38.34900798, 100, 1505485333000], [-0.49230609, 38.34900963, 101, 1505485332000], [-0.4922935, 38.34901179, 101, 1505485331000], [-0.4922785, 38.34901525, 101, 1505485330000], [-0.49226229, 38.34901963, 102, 1505485329000], [-0.49224198, 38.34902414, 102, 1505485328000], [-0.49220377, 38.34903053, 104, 1505485326000], [-0.49217936, 38.34903826, 105, 1505485325000], [-0.49215882, 38.3490456, 98, 1505485324000], [-0.49214122, 38.34905829, 99, 1505485323000], [-0.49212509, 38.34907208, 99, 1505485322000], [-0.49210788, 38.34908529, 98, 1505485321000], [-0.49208901, 38.34910311, 98, 1505485320000], [-0.49206441, 38.34912422, 98, 1505485319000], [-0.49203626, 38.34914374, 99, 1505485318000], [-0.49199779, 38.34917904, 100, 1505485316000], [-0.49197508, 38.34918417, 100, 1505485315000], [-0.49195181, 38.34918902, 100, 1505485314000], [-0.49192667, 38.34919525, 100, 1505485313000], [-0.49190225, 38.34920512, 100, 1505485312000], [-0.49187849, 38.34921577, 100, 1505485311000], [-0.49185643, 38.34922298, 100, 1505485310000], [-0.49183959, 38.34923113, 100, 1505485309000], [-0.49182166, 38.34923694, 100, 1505485308000], [-0.4918028, 38.34924322, 100, 1505485307000], [-0.49175542, 38.34924779, 100, 1505485305000], [-0.49172743, 38.34925, 101, 1505485304000], [-0.49169881, 38.3492533, 101, 1505485303000], [-0.49167511, 38.34925418, 101, 1505485302000], [-0.49166003, 38.349257, 102, 1505485301000], [-0.4916479, 38.34926999, 103, 1505485300000], [-0.49163359, 38.34929046, 99, 1505485299000], [-0.49161609, 38.3493084, 99, 1505485298000], [-0.49158893, 38.34931338, 99, 1505485297000], [-0.49154616, 38.3493314, 99, 1505485295000], [-0.49152656, 38.34934123, 99, 1505485294000], [-0.49150391, 38.3493495, 99, 1505485293000], [-0.49147993, 38.34935715, 99, 1505485292000], [-0.49145444, 38.34936192, 99, 1505485291000], [-0.49142298, 38.34936833, 99, 1505485290000], [-0.49138923, 38.34937755, 99, 1505485289000], [-0.49135066, 38.34938902, 99, 1505485288000], [-0.49131792, 38.3494031, 99, 1505485287000], [-0.49124888, 38.34944035, 99, 1505485285000], [-0.49121957, 38.34945825, 99, 1505485284000], [-0.49118599, 38.34947234, 99, 1505485283000], [-0.49116378, 38.34948074, 99, 1505485282000], [-0.49114629, 38.34947702, 99, 1505485281000], [-0.49112099, 38.34946911, 99, 1505485280000], [-0.49109701, 38.34946492, 99, 1505485279000], [-0.49106733, 38.34947468, 100, 1505485278000], [-0.49081689, 38.34976919, 102, 1505485277000], [-0.49074026, 38.34971223, 102, 1505485275000], [-0.49069491, 38.34969607, 102, 1505485274000], [-0.49065643, 38.34966519, 102, 1505485273000], [-0.49061841, 38.34964482, 102, 1505485272000], [-0.49060258, 38.3496314, 102, 1505485271000], [-0.4905918, 38.34964354, 102, 1505485269000], [-0.49059782, 38.34965111, 102, 1505485268000], [-0.49060116, 38.34965999, 102, 1505485267000], [-0.49061893, 38.34967333, 102, 1505485265000], [-0.49063679, 38.34967618, 102, 1505485264000], [-0.49066342, 38.3496752, 102, 1505485263000], [-0.49069233, 38.34967485, 102, 1505485262000], [-0.490722, 38.34967531, 102, 1505485261000], [-0.49075201, 38.34967689, 102, 1505485260000], [-0.49079416, 38.34969302, 102, 1505485259000], [-0.49084014, 38.34971155, 102, 1505485258000], [-0.49094367, 38.34975738, 102, 1505485255000], [-0.49096216, 38.34976927, 102, 1505485254000], [-0.49096618, 38.34977987, 102, 1505485253000], [-0.49097427, 38.34978964, 103, 1505485252000], [-0.49096994, 38.3497955, 103, 1505485251000], [-0.49094955, 38.34978823, 103, 1505485249000], [-0.49093971, 38.34977181, 103, 1505485248000], [-0.49092885, 38.3497543, 103, 1505485247000], [-0.49089857, 38.34971723, 103, 1505485245000], [-0.49088179, 38.34970578, 103, 1505485244000], [-0.49086494, 38.34971048, 104, 1505485242000], [-0.49085386, 38.34972552, 104, 1505485241000], [-0.49083902, 38.34974105, 105, 1505485240000], [-0.49083478, 38.34975664, 102, 1505485239000], [-0.49083669, 38.349772, 102, 1505485238000], [-0.49083786, 38.34978883, 102, 1505485237000], [-0.4908419, 38.3498063, 102, 1505485236000], [-0.49084412, 38.34984651, 102, 1505485234000], [-0.49084601, 38.34986467, 102, 1505485233000], [-0.49085164, 38.34988222, 102, 1505485232000], [-0.49086092, 38.34990108, 102, 1505485231000], [-0.49087077, 38.34992065, 102, 1505485230000], [-0.49088142, 38.3499425, 102, 1505485229000], [-0.49089399, 38.34996334, 102, 1505485228000], [-0.49091036, 38.34997747, 103, 1505485227000], [-0.4909285, 38.34999115, 103, 1505485226000], [-0.49095829, 38.34996194, 103, 1505485224000], [-0.49097492, 38.34994532, 103, 1505485223000], [-0.49099276, 38.34993155, 103, 1505485222000], [-0.49101127, 38.3499225, 103, 1505485221000], [-0.4910319, 38.34991166, 103, 1505485220000], [-0.49105251, 38.34990143, 104, 1505485219000], [-0.49107163, 38.34989644, 104, 1505485218000], [-0.49108813, 38.34989462, 104, 1505485217000], [-0.49110516, 38.34989051, 104, 1505485216000], [-0.49112218, 38.34988833, 105, 1505485215000], [-0.49116538, 38.34988694, 105, 1505485213000], [-0.49118421, 38.34988963, 105, 1505485212000], [-0.4912039, 38.34989202, 105, 1505485211000], [-0.49122147, 38.34989654, 105, 1505485210000], [-0.49123331, 38.34990469, 105, 1505485209000], [-0.49124467, 38.34991204, 105, 1505485208000], [-0.49125809, 38.34991711, 105, 1505485207000], [-0.49127489, 38.34991777, 105, 1505485206000], [-0.491296, 38.34991757, 105, 1505485205000], [-0.49131659, 38.34991378, 104, 1505485204000], [-0.49135356, 38.34991325, 104, 1505485202000], [-0.49137015, 38.34991217, 104, 1505485201000], [-0.49138544, 38.34991294, 104, 1505485200000], [-0.49139875, 38.34991707, 104, 1505485199000], [-0.49141204, 38.34992107, 105, 1505485198000], [-0.49142298, 38.34992733, 104, 1505485197000], [-0.49143516, 38.34993318, 104, 1505485196000], [-0.49144672, 38.34993769, 104, 1505485195000], [-0.49145557, 38.34994245, 105, 1505485194000], [-0.49146913, 38.34995804, 104, 1505485192000], [-0.49147116, 38.34996626, 105, 1505485191000], [-0.49147254, 38.34997542, 105, 1505485190000], [-0.49147225, 38.34998511, 105, 1505485189000], [-0.49147379, 38.34999364, 105, 1505485188000], [-0.49147355, 38.35000295, 106, 1505485187000], [-0.49147527, 38.35001403, 106, 1505485186000], [-0.49148697, 38.35002318, 107, 1505485185000], [-0.49149897, 38.3500341, 107, 1505485184000], [-0.49151353, 38.35004546, 106, 1505485183000], [-0.49153718, 38.35006926, 107, 1505485181000], [-0.49154372, 38.35008388, 107, 1505485180000], [-0.49154434, 38.35009935, 108, 1505485179000], [-0.49154474, 38.35011456, 108, 1505485178000], [-0.49153804, 38.35013063, 108, 1505485177000], [-0.4915315, 38.35014736, 108, 1505485176000], [-0.49152618, 38.35016433, 108, 1505485175000], [-0.49151914, 38.350181, 108, 1505485174000], [-0.49151702, 38.35019782, 108, 1505485173000], [-0.49152736, 38.35022533, 108, 1505485171000], [-0.49153421, 38.35023968, 108, 1505485170000], [-0.49153793, 38.35025437, 107, 1505485169000], [-0.49154589, 38.35026938, 107, 1505485168000], [-0.4915582, 38.35028358, 107, 1505485167000], [-0.49156792, 38.35029791, 107, 1505485166000], [-0.49157634, 38.35031415, 107, 1505485165000], [-0.49157584, 38.350334, 107, 1505485164000], [-0.49157793, 38.35035053, 107, 1505485163000], [-0.49158189, 38.35038142, 107, 1505485161000], [-0.49158825, 38.35039653, 107, 1505485160000], [-0.49159924, 38.35040879, 108, 1505485159000], [-0.49160963, 38.35042021, 108, 1505485158000], [-0.49161839, 38.35043182, 108, 1505485157000], [-0.49162849, 38.35044203, 108, 1505485156000], [-0.49163875, 38.35045275, 108, 1505485155000], [-0.49164464, 38.35046308, 108, 1505485154000], [-0.49165087, 38.3504718, 108, 1505485153000], [-0.49167541, 38.35048637, 108, 1505485151000], [-0.49169061, 38.35049112, 108, 1505485150000], [-0.49170944, 38.35049467, 108, 1505485149000], [-0.49172703, 38.3505024, 108, 1505485148000], [-0.49173795, 38.35051166, 108, 1505485147000], [-0.49174659, 38.35052244, 108, 1505485146000], [-0.49175581, 38.35053208, 109, 1505485145000], [-0.49176472, 38.35054065, 109, 1505485144000], [-0.49177264, 38.35055014, 109, 1505485143000], [-0.49177661, 38.35055942, 109, 1505485142000], [-0.49176605, 38.35058684, 110, 1505485140000], [-0.49175887, 38.35060178, 110, 1505485139000], [-0.49174667, 38.35061796, 111, 1505485138000], [-0.49173847, 38.35063421, 111, 1505485137000], [-0.49173689, 38.35065022, 111, 1505485136000], [-0.49173172, 38.35066583, 112, 1505485135000], [-0.49172966, 38.35068133, 112, 1505485134000], [-0.4917295, 38.35069555, 112, 1505485133000], [-0.49172633, 38.35071058, 112, 1505485132000], [-0.49172912, 38.35074046, 113, 1505485130000], [-0.49173729, 38.35075574, 114, 1505485129000], [-0.49174597, 38.35077071, 114, 1505485128000], [-0.49175256, 38.35078666, 114, 1505485127000], [-0.4917578, 38.35080159, 115, 1505485126000], [-0.49176335, 38.35081754, 115, 1505485125000], [-0.49177292, 38.35083276, 113, 1505485124000], [-0.49178277, 38.3508488, 113, 1505485123000], [-0.49179659, 38.35086306, 113, 1505485122000], [-0.49181303, 38.35089231, 113, 1505485120000], [-0.49182037, 38.35090609, 113, 1505485119000], [-0.49182725, 38.350919, 113, 1505485118000], [-0.49183306, 38.35093343, 114, 1505485117000], [-0.49183937, 38.35094801, 114, 1505485116000], [-0.49184494, 38.35096035, 114, 1505485115000], [-0.49185146, 38.3509706, 114, 1505485114000], [-0.49185484, 38.35098086, 114, 1505485113000], [-0.49185692, 38.35099224, 114, 1505485112000], [-0.49185402, 38.35100565, 114, 1505485111000], [-0.49185694, 38.35103189, 114, 1505485109000], [-0.49186212, 38.35104527, 114, 1505485108000], [-0.49186819, 38.35105903, 115, 1505485107000], [-0.49187528, 38.35107345, 115, 1505485106000], [-0.49188308, 38.35108713, 115, 1505485105000], [-0.4918911, 38.35110031, 116, 1505485104000], [-0.49189697, 38.35111531, 116, 1505485103000], [-0.49190346, 38.35113124, 116, 1505485102000], [-0.49191089, 38.35114786, 115, 1505485101000], [-0.49191198, 38.35117757, 116, 1505485099000], [-0.49191707, 38.35119186, 116, 1505485098000], [-0.49192692, 38.35120478, 116, 1505485097000], [-0.49194047, 38.35121631, 115, 1505485096000], [-0.49195345, 38.35122793, 115, 1505485095000], [-0.4919677, 38.35123919, 116, 1505485094000], [-0.49198332, 38.35124863, 115, 1505485093000], [-0.4919955, 38.35125799, 115, 1505485092000], [-0.49200707, 38.35126602, 115, 1505485091000], [-0.4920325, 38.35127181, 115, 1505485089000], [-0.49204661, 38.35127133, 115, 1505485088000], [-0.49206035, 38.35127043, 115, 1505485087000], [-0.49206738, 38.35126927, 115, 1505485086000], [-0.49206481, 38.35126783, 115, 1505485085000], [-0.4920582, 38.35126272, 115, 1505485084000], [-0.4920562, 38.35124853, 115, 1505485083000], [-0.49206916, 38.35124391, 115, 1505485082000], [-0.49208184, 38.35124439, 116, 1505485081000], [-0.49211525, 38.35125613, 117, 1505485079000], [-0.49213103, 38.35126454, 117, 1505485078000], [-0.49214492, 38.35127458, 117, 1505485077000], [-0.49215804, 38.35128698, 117, 1505485076000], [-0.49217026, 38.35130108, 117, 1505485075000], [-0.49217657, 38.35131562, 117, 1505485074000], [-0.49218715, 38.35132998, 117, 1505485073000], [-0.49219858, 38.35134322, 116, 1505485072000], [-0.49221114, 38.35135626, 116, 1505485071000], [-0.49224272, 38.35137472, 117, 1505485069000], [-0.49225561, 38.35138465, 117, 1505485068000], [-0.49226523, 38.35139608, 116, 1505485067000], [-0.49227258, 38.35140999, 116, 1505485066000], [-0.4922821, 38.35142288, 116, 1505485065000], [-0.49229128, 38.35143634, 116, 1505485064000], [-0.49230661, 38.35144815, 116, 1505485063000], [-0.49231473, 38.3514612, 116, 1505485062000], [-0.49231957, 38.35147529, 117, 1505485061000], [-0.49232262, 38.35149955, 117, 1505485059000], [-0.49232515, 38.35151239, 117, 1505485058000], [-0.49232912, 38.35152515, 117, 1505485057000], [-0.49233867, 38.35153595, 117, 1505485056000], [-0.49234662, 38.35154923, 116, 1505485055000], [-0.49235081, 38.35156267, 117, 1505485054000], [-0.49236017, 38.35157459, 117, 1505485053000], [-0.49236982, 38.35158654, 117, 1505485052000], [-0.49238162, 38.35159796, 117, 1505485051000], [-0.49240043, 38.35161956, 116, 1505485049000], [-0.49240418, 38.35163299, 116, 1505485048000], [-0.49240652, 38.3516459, 117, 1505485047000], [-0.49240598, 38.35166016, 117, 1505485046000], [-0.49241032, 38.35167423, 117, 1505485045000], [-0.4924203, 38.35168681, 117, 1505485044000], [-0.49243191, 38.35169818, 116, 1505485043000], [-0.4924395, 38.35171175, 116, 1505485042000], [-0.49244266, 38.35172828, 116, 1505485041000], [-0.49244983, 38.35176062, 118, 1505485039000], [-0.49245094, 38.35177662, 118, 1505485038000], [-0.49245011, 38.35179252, 118, 1505485037000], [-0.49244583, 38.35180965, 119, 1505485036000], [-0.49244297, 38.35182171, 119, 1505485035000], [-0.49244207, 38.3518308, 119, 1505485034000], [-0.49244684, 38.35184595, 118, 1505485033000], [-0.49245423, 38.35185943, 118, 1505485032000], [-0.49245968, 38.35187158, 118, 1505485031000], [-0.49248243, 38.35188979, 117, 1505485029000], [-0.49249323, 38.35190073, 117, 1505485028000], [-0.49250371, 38.35191439, 117, 1505485027000], [-0.49251382, 38.35192937, 117, 1505485026000], [-0.49252044, 38.35194726, 117, 1505485025000], [-0.49252838, 38.35196646, 117, 1505485024000], [-0.49253685, 38.35198724, 117, 1505485023000], [-0.4925453, 38.35200819, 117, 1505485022000], [-0.49254871, 38.35202946, 117, 1505485021000], [-0.4925289, 38.35205306, 116, 1505485019000], [-0.49252753, 38.35204571, 117, 1505485018000], [-0.49253321, 38.35203048, 116, 1505485017000], [-0.49254505, 38.35201777, 116, 1505485016000], [-0.49255885, 38.3520069, 116, 1505485015000], [-0.49257416, 38.35199389, 116, 1505485014000], [-0.49259027, 38.35198072, 116, 1505485013000], [-0.49260279, 38.35196501, 116, 1505485012000], [-0.49261164, 38.35194916, 117, 1505485011000], [-0.49262001, 38.35191716, 117, 1505485009000], [-0.492622, 38.35190139, 117, 1505485008000], [-0.49262463, 38.35188609, 117, 1505485007000], [-0.49262838, 38.35187168, 117, 1505485006000], [-0.49263509, 38.35185639, 117, 1505485005000], [-0.49263769, 38.3518412, 117, 1505485004000], [-0.49263701, 38.3518252, 117, 1505485003000], [-0.49263379, 38.35180968, 117, 1505485002000], [-0.49263137, 38.351795, 117, 1505485001000], [-0.49263069, 38.35177997, 117, 1505485000000], [-0.49263434, 38.35175002, 116, 1505484998000], [-0.49263794, 38.35173364, 116, 1505484997000], [-0.49264058, 38.35171807, 116, 1505484996000], [-0.4926417, 38.35170318, 116, 1505484995000], [-0.49264376, 38.35168727, 116, 1505484994000], [-0.49264246, 38.35167348, 116, 1505484993000], [-0.49263907, 38.35165877, 116, 1505484992000], [-0.49263343, 38.35164456, 116, 1505484991000], [-0.49262564, 38.35162966, 116, 1505484990000], [-0.49261311, 38.3516044, 116, 1505484988000], [-0.49261244, 38.35159138, 116, 1505484987000], [-0.49261195, 38.3515766, 115, 1505484986000], [-0.49261141, 38.35156349, 115, 1505484985000], [-0.49261043, 38.35154903, 114, 1505484984000], [-0.49260634, 38.35153485, 114, 1505484983000], [-0.49260127, 38.35151961, 114, 1505484982000], [-0.49259965, 38.35150317, 114, 1505484981000], [-0.49259761, 38.35148581, 114, 1505484980000], [-0.49259244, 38.35145165, 114, 1505484978000], [-0.4925893, 38.35143594, 114, 1505484977000], [-0.49258503, 38.35141901, 113, 1505484976000], [-0.49258056, 38.35140563, 113, 1505484975000], [-0.49257308, 38.35139183, 113, 1505484974000], [-0.49256212, 38.35137821, 113, 1505484973000], [-0.49254855, 38.35136551, 113, 1505484972000], [-0.49253528, 38.35135226, 113, 1505484971000], [-0.49252414, 38.35133715, 113, 1505484970000], [-0.49251171, 38.35130789, 113, 1505484968000], [-0.49250594, 38.35129419, 113, 1505484967000], [-0.49250088, 38.35128017, 113, 1505484966000], [-0.49249873, 38.35126507, 113, 1505484965000], [-0.49249879, 38.35125129, 113, 1505484964000], [-0.4925, 38.35123797, 113, 1505484963000], [-0.4925002, 38.35122502, 114, 1505484962000], [-0.49249724, 38.35121216, 113, 1505484961000], [-0.49249193, 38.35119935, 113, 1505484960000], [-0.49248838, 38.35116925, 113, 1505484958000], [-0.49249247, 38.35115433, 113, 1505484957000], [-0.49249404, 38.35113994, 113, 1505484956000], [-0.49249353, 38.35112752, 113, 1505484955000], [-0.4924942, 38.35111412, 112, 1505484954000], [-0.49249519, 38.35110112, 113, 1505484953000], [-0.4924943, 38.35108774, 112, 1505484952000], [-0.49249074, 38.35107435, 112, 1505484951000], [-0.4924847, 38.35106191, 112, 1505484950000], [-0.49247622, 38.35104979, 113, 1505484949000], [-0.49246019, 38.35102796, 113, 1505484947000], [-0.4924545, 38.3510168, 113, 1505484946000], [-0.49245113, 38.35100458, 113, 1505484945000], [-0.49245268, 38.35099135, 113, 1505484944000], [-0.49245258, 38.35097824, 113, 1505484943000], [-0.49245047, 38.350964, 113, 1505484942000], [-0.49244344, 38.3509499, 113, 1505484941000], [-0.49243504, 38.35093702, 113, 1505484940000], [-0.49242434, 38.35092522, 112, 1505484939000], [-0.49239725, 38.35090352, 112, 1505484937000], [-0.49238407, 38.35089101, 112, 1505484936000], [-0.49237684, 38.35087837, 111, 1505484935000], [-0.49237081, 38.35086513, 111, 1505484934000], [-0.49236455, 38.35084999, 110, 1505484933000], [-0.4923593, 38.35083571, 110, 1505484932000], [-0.4923528, 38.3508213, 110, 1505484931000], [-0.49234877, 38.35080621, 109, 1505484930000], [-0.49234249, 38.35079177, 109, 1505484929000], [-0.49232999, 38.35076274, 109, 1505484927000], [-0.49232431, 38.35074619, 108, 1505484926000], [-0.49232091, 38.35073102, 109, 1505484925000], [-0.49231865, 38.3507146, 108, 1505484924000], [-0.49231861, 38.35069829, 108, 1505484923000], [-0.49232045, 38.35068331, 108, 1505484922000], [-0.49232595, 38.35066879, 107, 1505484921000], [-0.49232995, 38.35065586, 107, 1505484920000], [-0.49233415, 38.35064141, 107, 1505484919000], [-0.49233524, 38.35061607, 106, 1505484917000], [-0.49233126, 38.35060433, 106, 1505484916000], [-0.49232563, 38.3505939, 106, 1505484915000], [-0.49232047, 38.35058375, 106, 1505484914000], [-0.49231278, 38.35057344, 106, 1505484913000], [-0.49230603, 38.35056104, 107, 1505484912000], [-0.49229807, 38.35054501, 107, 1505484911000], [-0.49228877, 38.35052856, 106, 1505484910000], [-0.49228164, 38.35051138, 106, 1505484909000], [-0.492276, 38.35048385, 105, 1505484907000], [-0.49227597, 38.3504696, 105, 1505484906000], [-0.49227674, 38.35045434, 105, 1505484905000], [-0.49227486, 38.35043896, 105, 1505484904000], [-0.49227207, 38.35042341, 105, 1505484903000], [-0.49226944, 38.35040762, 105, 1505484902000], [-0.49226554, 38.3503922, 105, 1505484901000], [-0.49225951, 38.35037875, 105, 1505484900000], [-0.49225471, 38.35036527, 104, 1505484899000], [-0.49225146, 38.35033725, 103, 1505484897000], [-0.49224917, 38.35032342, 103, 1505484896000], [-0.49224834, 38.35030914, 103, 1505484895000], [-0.49224342, 38.35029582, 103, 1505484894000], [-0.49223855, 38.35028478, 103, 1505484893000], [-0.49223396, 38.35027156, 102, 1505484892000], [-0.49223158, 38.35025869, 102, 1505484891000], [-0.49222953, 38.35024685, 102, 1505484890000], [-0.49222707, 38.3502343, 102, 1505484889000], [-0.49221953, 38.35020278, 101, 1505484887000], [-0.49221901, 38.35018917, 100, 1505484886000], [-0.49222009, 38.35017387, 101, 1505484885000], [-0.49222037, 38.35015888, 101, 1505484884000], [-0.49222012, 38.35014433, 101, 1505484883000], [-0.49222086, 38.35013016, 101, 1505484882000], [-0.49222251, 38.35011628, 101, 1505484881000], [-0.49222167, 38.35010217, 100, 1505484880000], [-0.49222292, 38.35009011, 101, 1505484879000], [-0.49221792, 38.35005791, 101, 1505484877000], [-0.49221357, 38.35004244, 101, 1505484876000], [-0.49220813, 38.35002637, 101, 1505484875000], [-0.4922014, 38.35000949, 101, 1505484874000], [-0.49219395, 38.34999125, 101, 1505484873000], [-0.49218584, 38.34997366, 101, 1505484872000], [-0.49217883, 38.34995698, 100, 1505484871000], [-0.49217507, 38.34994284, 101, 1505484870000], [-0.49217216, 38.34992749, 101, 1505484869000], [-0.49216002, 38.34989685, 101, 1505484867000], [-0.49215397, 38.34988323, 100, 1505484866000], [-0.49214836, 38.34986947, 100, 1505484865000], [-0.49214032, 38.34985651, 100, 1505484864000], [-0.49213101, 38.34984481, 100, 1505484863000], [-0.49212785, 38.3498307, 100, 1505484862000], [-0.49212748, 38.34981533, 100, 1505484861000], [-0.49213033, 38.34980044, 99, 1505484860000], [-0.49213668, 38.34978697, 99, 1505484859000], [-0.49215968, 38.34976541, 99, 1505484857000], [-0.49217387, 38.34975393, 99, 1505484856000], [-0.49218626, 38.34974177, 99, 1505484855000], [-0.49219896, 38.3497306, 98, 1505484854000], [-0.49221085, 38.34971962, 98, 1505484853000], [-0.4922185, 38.34970701, 98, 1505484852000], [-0.49221981, 38.34969161, 98, 1505484851000], [-0.4922226, 38.34967638, 98, 1505484850000], [-0.49222475, 38.34965993, 98, 1505484849000], [-0.49223164, 38.34962792, 97, 1505484847000], [-0.49223231, 38.34961528, 98, 1505484846000], [-0.49223419, 38.34959875, 98, 1505484845000], [-0.49223697, 38.34958236, 98, 1505484844000], [-0.49224365, 38.34956704, 97, 1505484843000], [-0.492255, 38.34955483, 97, 1505484842000], [-0.49227106, 38.34954488, 97, 1505484841000], [-0.49228809, 38.34953385, 97, 1505484840000], [-0.49230507, 38.34952283, 96, 1505484839000], [-0.49232221, 38.34951221, 96, 1505484838000], [-0.49234778, 38.34949073, 95, 1505484836000], [-0.49235464, 38.34947984, 97, 1505484835000], [-0.4923582, 38.34946853, 96, 1505484834000], [-0.49235735, 38.34945576, 96, 1505484833000], [-0.4923584, 38.34944409, 96, 1505484832000], [-0.49236481, 38.34943357, 96, 1505484831000], [-0.4923726, 38.34942546, 95, 1505484830000], [-0.49238067, 38.34941808, 96, 1505484829000], [-0.49239071, 38.34940864, 96, 1505484828000], [-0.49241646, 38.34939332, 96, 1505484826000], [-0.4924277, 38.34938544, 96, 1505484825000], [-0.49243663, 38.34937638, 96, 1505484824000], [-0.49244572, 38.34936708, 96, 1505484823000], [-0.49245798, 38.34935965, 96, 1505484822000], [-0.49247429, 38.34935337, 96, 1505484821000], [-0.49249147, 38.34934831, 96, 1505484820000], [-0.49250859, 38.34934498, 96, 1505484819000], [-0.49252402, 38.34933986, 96, 1505484818000], [-0.4925465, 38.34932428, 96, 1505484816000], [-0.4925585, 38.34931728, 97, 1505484815000], [-0.49256852, 38.34931176, 96, 1505484814000], [-0.49257712, 38.34930563, 97, 1505484813000], [-0.4925834, 38.3492968, 97, 1505484812000], [-0.49259068, 38.34928828, 96, 1505484811000], [-0.49260104, 38.3492818, 96, 1505484810000], [-0.49261138, 38.34927719, 96, 1505484809000], [-0.49262263, 38.34927074, 96, 1505484808000], [-0.49263738, 38.34925163, 96, 1505484806000], [-0.49264482, 38.34924227, 96, 1505484805000], [-0.49265171, 38.34923304, 96, 1505484804000], [-0.4926589, 38.34922468, 96, 1505484803000], [-0.49266628, 38.34921853, 96, 1505484802000], [-0.49267496, 38.34921221, 95, 1505484801000], [-0.49268292, 38.34920552, 95, 1505484800000], [-0.49268846, 38.34920054, 96, 1505484799000], [-0.49269577, 38.34919376, 96, 1505484798000], [-0.49272054, 38.3491812, 95, 1505484796000], [-0.49273298, 38.34917198, 95, 1505484795000], [-0.49274341, 38.34915871, 95, 1505484794000], [-0.49275113, 38.34914236, 95, 1505484793000], [-0.49275205, 38.34912701, 95, 1505484792000], [-0.49274882, 38.34911316, 94, 1505484791000], [-0.49273687, 38.34910151, 94, 1505484790000], [-0.4927247, 38.34908937, 94, 1505484789000], [-0.49271352, 38.34907578, 94, 1505484788000], [-0.49269453, 38.3490503, 94, 1505484786000], [-0.49269414, 38.34903876, 94, 1505484785000], [-0.49270079, 38.34902921, 94, 1505484784000], [-0.49271224, 38.34902304, 94, 1505484783000], [-0.49272755, 38.34902075, 94, 1505484782000], [-0.49274145, 38.3490173, 94, 1505484781000], [-0.49275368, 38.34901297, 94, 1505484780000], [-0.49276461, 38.34900633, 94, 1505484779000], [-0.49277089, 38.34899624, 94, 1505484778000], [-0.49277161, 38.34898464, 94, 1505484777000], [-0.49274726, 38.34896563, 94, 1505484775000], [-0.49272944, 38.34896119, 94, 1505484774000], [-0.49271141, 38.34895614, 94, 1505484773000], [-0.49269402, 38.34895042, 94, 1505484772000], [-0.49267616, 38.34894485, 94, 1505484771000], [-0.49265716, 38.34894267, 94, 1505484770000], [-0.49263992, 38.34894232, 95, 1505484769000], [-0.49262636, 38.34894524, 95, 1505484768000], [-0.49261476, 38.34895325, 95, 1505484767000], [-0.49260426, 38.3489633, 94, 1505484766000], [-0.49258184, 38.34898562, 94, 1505484764000], [-0.49256605, 38.34899649, 94, 1505484763000], [-0.49254623, 38.34900336, 94, 1505484762000], [-0.49252618, 38.34900637, 94, 1505484761000], [-0.49251297, 38.34900038, 94, 1505484760000], [-0.49250653, 38.34899115, 94, 1505484759000], [-0.49250038, 38.34898107, 94, 1505484758000], [-0.49249428, 38.34896976, 95, 1505484757000], [-0.49249134, 38.34895769, 94, 1505484756000], [-0.49249988, 38.34893409, 94, 1505484754000], [-0.49251376, 38.34892609, 95, 1505484753000], [-0.49253137, 38.34891833, 95, 1505484752000], [-0.49254681, 38.34890856, 95, 1505484751000], [-0.49256214, 38.34890049, 95, 1505484750000], [-0.49257903, 38.3488926, 95, 1505484749000], [-0.49259727, 38.34888729, 95, 1505484748000], [-0.49261589, 38.34888347, 96, 1505484747000], [-0.49263265, 38.34887641, 96, 1505484746000], [-0.49266445, 38.34885907, 97, 1505484744000], [-0.4926792, 38.34884749, 96, 1505484743000], [-0.49268768, 38.34883465, 96, 1505484742000], [-0.49269139, 38.3488209, 96, 1505484741000], [-0.49269218, 38.34880823, 96, 1505484740000], [-0.49269082, 38.34879499, 96, 1505484739000], [-0.49268708, 38.34878281, 97, 1505484738000], [-0.49268572, 38.34876889, 97, 1505484737000], [-0.49268449, 38.34875403, 98, 1505484736000], [-0.49268973, 38.34872302, 98, 1505484734000], [-0.49269101, 38.34871045, 98, 1505484733000], [-0.492692, 38.34869946, 99, 1505484732000], [-0.49269433, 38.34868876, 98, 1505484731000], [-0.49269902, 38.34867756, 100, 1505484730000], [-0.49269505, 38.34866675, 99, 1505484729000], [-0.49269199, 38.34865723, 99, 1505484728000], [-0.49268846, 38.34864834, 100, 1505484727000], [-0.49268641, 38.34863948, 100, 1505484726000], [-0.49268974, 38.34862429, 101, 1505484724000], [-0.49269435, 38.34861529, 102, 1505484723000], [-0.49269852, 38.3486072, 101, 1505484722000], [-0.49270144, 38.34860013, 101, 1505484721000], [-0.49270673, 38.34859264, 102, 1505484720000], [-0.49270347, 38.34858585, 102, 1505484719000], [-0.49269443, 38.34857944, 101, 1505484718000], [-0.49268658, 38.34857123, 101, 1505484717000], [-0.49267743, 38.34856337, 102, 1505484716000], [-0.4926576, 38.34854476, 102, 1505484714000], [-0.49264639, 38.34853524, 102, 1505484713000], [-0.49263867, 38.34852631, 103, 1505484712000], [-0.49263269, 38.34851832, 103, 1505484711000], [-0.49262765, 38.3485111, 102, 1505484710000], [-0.49262085, 38.34850518, 101, 1505484709000], [-0.49261598, 38.34850186, 101, 1505484708000], [-0.49261299, 38.34850026, 103, 1505484707000], [-0.49260845, 38.34849491, 104, 1505484706000], [-0.49258881, 38.34847927, 103, 1505484704000], [-0.49257349, 38.34847214, 102, 1505484703000], [-0.49255982, 38.34846452, 102, 1505484702000], [-0.49254773, 38.34845383, 102, 1505484701000], [-0.49254056, 38.34844101, 102, 1505484700000], [-0.49253053, 38.34843193, 103, 1505484699000], [-0.4925258, 38.34842805, 103, 1505484698000], [-0.49252077, 38.34842666, 104, 1505484697000], [-0.4925187, 38.34842626, 105, 1505484696000], [-0.49252639, 38.34843192, 105, 1505484694000], [-0.49253041, 38.34843427, 104, 1505484693000], [-0.49253673, 38.34843763, 104, 1505484692000], [-0.49254461, 38.3484374, 102, 1505484691000], [-0.49254808, 38.34843669, 101, 1505484690000], [-0.49255349, 38.34843445, 101, 1505484689000], [-0.49255772, 38.34843107, 101, 1505484688000], [-0.49257249, 38.34843564, 99, 1505484687000], [-0.4925884, 38.34843072, 100, 1505484686000], [-0.49261866, 38.34843058, 97, 1505484684000], [-0.49261195, 38.34843129, 97, 1505484683000], [-0.49262101, 38.34843879, 98, 1505484682000], [-0.492628, 38.34844135, 97, 1505484681000], [-0.49264018, 38.34845237, 97, 1505484680000], [-0.49269147, 38.34847895, 98, 1505484679000], [-0.49265428, 38.34848394, 100, 1505484678000], [-0.49264998, 38.34848203, 102, 1505484677000], [-0.49265227, 38.34848495, 104, 1505484676000], [-0.49264298, 38.34846134, 101, 1505484675000]]",
                    "2017-09-15 14:23:11",
                    "2017-09-21 10:32:35"
            };

            GenericRecord r = recordList.get(0);
            Object[] v = r.getValues();
            System.out.println(Arrays.asList(v));

            assertThat(r.getPrimaryKey(), is(ImmutableList.of(expected[0])));
            assertThat(r.get("activity_id"), is(expected[1]));
            assertThat(r.get("splits"), is(expected[2]));
            assertThat(r.get("gps_position"), is(expected[3]));
            assertThat(r.get("created_at"), is(expected[4]));
            assertThat(r.get("updated_at"), is(expected[5]));

            GenericRecord r1 = recordList.get(0);
            System.out.println(Arrays.asList(r1.getValues()));
            assertThat(r1.getPrimaryKey(), is(ImmutableList.of(1L)));
            assertThat(r1.get("c_float"), is(0.0F));
            assertThat(r1.get("c_real"), is(0.0F));
            assertThat(r1.get("c_double"), is(0.0D));

            GenericRecord r2 = recordList.get(1);
            System.out.println(Arrays.asList(r2.getValues()));
            assertThat(r2.getPrimaryKey(), is(ImmutableList.of(2L)));
            assertThat(r2.get("c_float"), is(0.56789F));
            assertThat(r2.get("c_real"), is(0.12345F));
            assertThat(r2.get("c_double"), is(0.987654321D));

            GenericRecord r3 = recordList.get(2);
            System.out.println(Arrays.asList(r2.getValues()));
            assertThat(r3.getPrimaryKey(), is(ImmutableList.of(3L)));
            assertThat(r3.get("c_float"), is(1.0F));
            assertThat(r3.get("c_real"), is(-1.0F));
            assertThat(r3.get("c_double"), is(-1.0D));

            GenericRecord r4 = recordList.get(3);
            System.out.println(Arrays.asList(r3.getValues()));
            assertThat(r4.getPrimaryKey(), is(ImmutableList.of(4L)));
            assertThat(r4.get("c_float"), is(222.22F));
            assertThat(r4.get("c_real"), is(222.22F));
            assertThat(r4.get("c_double"), is(3333.333D));

            GenericRecord r5 = recordList.get(4);
            System.out.println(Arrays.asList(r4.getValues()));
            assertThat(r5.getPrimaryKey(), is(ImmutableList.of(5L)));
            assertThat(r5.get("c_float"), is(12345678.1234F));
            assertThat(r5.get("c_real"), is(12345678.1234F));
            assertThat(r5.get("c_double"), is(1234567890.123456D));

            GenericRecord r6 = recordList.get(5);
            System.out.println(Arrays.asList(r5.getValues()));
            assertThat(r6.getPrimaryKey(), is(ImmutableList.of(6L)));
            assertThat(r6.get("c_float"), is(-12345678.1234F));
            assertThat(r6.get("c_real"), is(-12345678.1234F));
            assertThat(r6.get("c_double"), is(-1234567890.123456D));
        };
    }
}

